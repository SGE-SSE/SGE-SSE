<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SAI GANESH ELECTRICALS - SSE</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/FileSaver.js/2.0.5/FileSaver.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 0; padding: 0;
      background: #f4f6f9;
    }
    header {
      background: linear-gradient(to right, #2c3e50, #3498db);
      color: white; padding: 20px; text-align: center;
    }
    .container { padding: 20px; }
    h2 { margin-top: 0; }
    input, textarea, button {
      padding: 10px; margin: 5px; border-radius: 5px; border: 1px solid #ccc;
    }
    button {
      cursor: pointer; font-weight: bold;
    }
    #selectedItems { margin-top: 15px; background: white; padding: 10px; border-radius: 5px; }
    .item-row { display: flex; justify-content: space-between; align-items: center; padding: 5px 0; }
    .remove-btn {
      background: #e74c3c; color: white; border: none; padding: 5px 10px; border-radius: 5px;
    }
    .send-btn {
      background: #3498db; color: white; border: none; padding: 10px 15px; border-radius: 5px;
      margin-top: 10px;
    }
    .company-box {
      background: #34495e; color: white; padding: 15px; border-radius: 8px; margin-bottom: 20px;
    }
  </style>
</head>
<body>

<header>
  <h1>SAI GANESH ELECTRICALS - SSE</h1>
</header>

<div class="container">
  <!-- Company Details -->
  <div class="company-box">
    <b>Prop:</b> Dasari Krishna — <b>Phone:</b> 8987576057 —
    <b>Email:</b> krishnadssge@gmail.com <br>
    <b>Sales Executive:</b> Vindharsha —
    <b>Email:</b> vindharsha12@gmail.com —
    <b>WhatsApp:</b> 7483362854
  </div>

  <!-- Search -->
  <h2>Search Inventory</h2>
  <input type="text" id="searchBox" placeholder="Type to search items (e.g., 1.5sqmm, 4sqmm, Conduit, Fan)">
  <div id="searchResults"></div>

  <!-- Selected Items -->
  <h2>Selected Items</h2>
  <div id="selectedItems"></div>

  <!-- Customer Details -->
  <h2>Customer Details & Send Enquiry</h2>
  <form id="enquiryForm" action="https://formspree.io/f/xnnzygoz" method="POST">
    <input type="text" name="name" placeholder="Your Name" required><br>
    <input type="text" name="phone" placeholder="Your Phone" required><br>
    <input type="email" name="email" placeholder="Your Email" required><br>
    <textarea name="message" placeholder="Additional message (optional)"></textarea><br>
    <input type="hidden" name="selectedItems" id="hiddenSelectedItems">
    <button type="submit" class="send-btn">Send via Email</button>
  </form>
</div>

<script>
let inventory = [];
let selectedItems = [];

// Load Excel file
fetch("cc.xlsx").then(res => res.arrayBuffer()).then(data => {
  let workbook = XLSX.read(data, { type: "array" });
  let sheet = workbook.Sheets[workbook.SheetNames[0]];
  inventory = XLSX.utils.sheet_to_json(sheet);
});

// Search function
document.getElementById("searchBox").addEventListener("input", function() {
  let query = this.value.toLowerCase();
  let results = inventory.filter(row => row.Item.toLowerCase().includes(query));
  let resultsDiv = document.getElementById("searchResults");
  resultsDiv.innerHTML = "";
  results.forEach(item => {
    let div = document.createElement("div");
    div.textContent = item.Item;
    div.style.cursor = "pointer";
    div.onclick = () => {
      let qty = prompt("Enter quantity for " + item.Item);
      if (qty && !isNaN(qty)) {
        selectedItems.push({
          name: item.Item,
          qty: qty,
          unit: item.Unit || "Nos"
        });
        renderSelectedItems();
      }
    };
    resultsDiv.appendChild(div);
  });
});

// Render selected items
function renderSelectedItems() {
  let container = document.getElementById("selectedItems");
  container.innerHTML = "";
  selectedItems.forEach((item, index) => {
    let row = document.createElement("div");
    row.className = "item-row";
    row.innerHTML = `
      <span>${item.name} — ${item.qty} ${item.unit}</span>
      <button class="remove-btn" onclick="removeItem(${index})">Remove</button>
    `;
    container.appendChild(row);
  });
  document.getElementById("hiddenSelectedItems").value =
    selectedItems.map(i => `${i.name} — ${i.qty} ${i.unit}`).join("\n");
}

// Remove item
function removeItem(index) {
  selectedItems.splice(index, 1);
  renderSelectedItems();
}

// Handle form submission (show success without leaving page)
document.getElementById("enquiryForm").addEventListener("submit", function(e) {
  e.preventDefault();
  let formData = new FormData(this);
  fetch(this.action, { method: "POST", body: formData })
    .then(() => {
      Swal.fire("✅ Success!", "Your enquiry has been submitted successfully.", "success");
      this.reset();
      selectedItems = [];
      renderSelectedItems();
    })
    .catch(() => Swal.fire("❌ Error", "Something went wrong.", "error"));
});
</script>

</body>
</html> 
