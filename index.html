<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SAI GANESH ELECTRICALS - SSE</title>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; margin: 20px; }
    .container { max-width: 800px; margin: auto; }
    input, button { margin: 5px; padding: 8px; }
    .selected { margin-top: 20px; }
    .item { margin: 5px 0; }
    .remove { color: red; cursor: pointer; margin-left: 10px; }
  </style>
</head>
<body>
  <div class="container">
    <h2>SAI GANESH ELECTRICALS - SSE</h2>
    <p><b>Prop:</b> Dasari Krishna — <b>Phone:</b> 8987156057 —
       <b>Email:</b> krishnasge@gmail.com</p>
    <p><b>Sales Executive:</b> Vinodharsha —
       <b>Email:</b> vinodharsha12@gmail.com —
       <b>WhatsApp:</b> 7483328254</p>

    <h3>Search Inventory</h3>
    <input type="text" id="searchBox" placeholder="Type to search items...">
    <div id="suggestions"></div>

    <div class="selected">
      <h3>Selected Items</h3>
      <div id="selectedItems"></div>
    </div>

    <h3>Customer Details & Send Enquiry</h3>
    <input type="text" id="custName" placeholder="Your Name"><br>
    <input type="email" id="custEmail" placeholder="Your Email"><br>
    <input type="text" id="custPhone" placeholder="Your Phone"><br>
    <input type="text" id="custMsg" placeholder="Additional message (Optional)"><br>
    <button onclick="sendEmail()">Send via Email</button>
    <button onclick="sendWhatsApp()">Send via WhatsApp</button>
  </div>

  <script>
    let inventory = [];
    let selectedItems = [];

    // Load Excel file
    fetch('cc.xlsx')
      .then(res => res.arrayBuffer())
      .then(data => {
        const workbook = XLSX.read(data, { type: 'array' });
        const sheet = workbook.Sheets[workbook.SheetNames[0]];
        inventory = XLSX.utils.sheet_to_json(sheet); // Will give objects {Item, Category, Unit}
      });

    // Search filter
    document.getElementById("searchBox").addEventListener("input", function() {
      let query = this.value.toLowerCase();
      let suggestions = document.getElementById("suggestions");
      suggestions.innerHTML = "";
      if (query.length === 0) return;

      let results = inventory.filter(row => row.Item && row.Item.toLowerCase().includes(query));
      results.slice(0, 5).forEach(item => {
        let div = document.createElement("div");
        div.textContent = `${item.Item} (${item.Unit || ""})`;
        div.style.cursor = "pointer";
        div.onclick = () => addItem(item);
        suggestions.appendChild(div);
      });
    });

    // Add item
    function addItem(item) {
      selectedItems.push(item);
      renderSelected();
      document.getElementById("suggestions").innerHTML = "";
      document.getElementById("searchBox").value = "";
    }

    // Render selected
    function renderSelected() {
      let container = document.getElementById("selectedItems");
      container.innerHTML = "";
      selectedItems.forEach((item, idx) => {
        let div = document.createElement("div");
        div.className = "item";
        div.innerHTML = `${item.Item} — ${item.Unit || ""} <span class="remove" onclick="removeItem(${idx})">[Remove]</span>`;
        container.appendChild(div);
      });
    }

    // Remove
    function removeItem(index) {
      selectedItems.splice(index, 1);
      renderSelected();
    }

    // Email
    function sendEmail() {
      let body = "Selected Items:\n" + selectedItems.map(i => `${i.Item} — ${i.Unit || ""}`).join("\n");
      body += `\n\nName: ${document.getElementById("custName").value}\nEmail: ${document.getElementById("custEmail").value}\nPhone: ${document.getElementById("custPhone").value}\nMessage: ${document.getElementById("custMsg").value}`;
      window.location.href = `mailto:krishnasge@gmail.com?subject=Enquiry&body=${encodeURIComponent(body)}`;
    }

    // WhatsApp
    function sendWhatsApp() {
      let msg = "Selected Items:\n" + selectedItems.map(i => `${i.Item} — ${i.Unit || ""}`).join("\n");
      msg += `\n\nName: ${document.getElementById("custName").value}\nEmail: ${document.getElementById("custEmail").value}\nPhone: ${document.getElementById("custPhone").value}\nMessage: ${document.getElementById("custMsg").value}`;
      window.open(`https://wa.me/918987156057?text=${encodeURIComponent(msg)}`, "_blank");
    }
  </script>
</body>
</html> 
