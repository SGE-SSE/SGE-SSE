<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>SAI GANESH ELECTRICALS - SSE</title>
  <style>
    body { font-family: Arial, sans-serif; margin: 0; padding: 0; }
    header { background: #1e40af; color: white; padding: 15px; text-align: center; }
    h1 { margin: 0; font-size: 20px; }
    .contact { font-size: 14px; margin-top: 5px; }
    .container { padding: 20px; max-width: 900px; margin: auto; }
    .search-box { width: 100%; padding: 8px; margin-bottom: 15px; }
    .selected { margin: 15px 0; }
    .selected-item { display: flex; justify-content: space-between; padding: 5px; background: #f0f0f0; margin-bottom: 5px; border-radius: 5px; }
    .remove-btn { background: red; color: white; border: none; padding: 2px 8px; cursor: pointer; border-radius: 3px; }
    .form { margin-top: 20px; }
    .form input, .form textarea { width: 100%; padding: 8px; margin: 5px 0; border: 1px solid #ccc; border-radius: 4px; }
    .form button { margin-top: 10px; padding: 10px; width: 48%; border: none; cursor: pointer; border-radius: 5px; }
    .btn-email { background: #2563eb; color: white; }
    .btn-whatsapp { background: #25d366; color: white; }
    .success { color: green; font-weight: bold; margin-top: 10px; }
  </style>
</head>
<body>
  <header>
    <h1>SAI GANESH ELECTRICALS - SSE</h1>
    <div class="contact">
      <b>Prop:</b> Dasari Krishna ‚Äî üìû 9885750657 ‚Äî ‚úâÔ∏è krishnasge@gmail.com <br>
      <b>Sales Executive:</b> Vindoharsha ‚Äî ‚úâÔ∏è vindoharsha12@gmail.com ‚Äî WhatsApp: 7483328354
    </div>
  </header>

  <div class="container">
    <input type="text" id="search" class="search-box" placeholder="Type to search items (e.g. 1.5sqmm, 4sqmm conduit, fan)">
    <div id="selected" class="selected"><b>Selected Items</b></div>

    <form id="enquiryForm" class="form">
      <input type="text" name="name" placeholder="Your Name" required>
      <input type="email" name="email" placeholder="Your Email" required>
      <input type="text" name="phone" placeholder="Your Phone" required>
      <textarea name="message" placeholder="Additional message (optional)"></textarea>
      <div>
        <button type="submit" class="btn-email">Send via Email</button>
        <button type="button" onclick="sendWhatsApp()" class="btn-whatsapp">Send via WhatsApp</button>
      </div>
      <div id="successMessage" class="success" style="display:none;">‚úÖ Successfully submitted!</div>
    </form>
  </div>

  <script>
    // ‚úÖ Inventory directly inside code (from your cc.xlsx)
    const inventory = [
      { Item: "0.4x2Pair 100mtr Telephone Wire", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "0.5sqmm 2core CCTV Camera Wire", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "0.5sqmm Single Core Copper Flexible", Category: "Wires & Cables", Unit: "MTRS" },
      { Item: "0.5x2Pair Telephone Cable 90mtr Coil", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "1.5sqmm 2core Copper Flexible Wire", Category: "Wires & Cables", Unit: "MTRS" },
      { Item: "1.5x2Core COPPER FLEXIBLE Cable (Chk)", Category: "Wires & Cables", Unit: "MTRS" },
      { Item: "1.5sqmm 300mtr Ind Copper Wire Frls", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "1.5sqmm 180mtr Ind Copper Wire", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "1.5sqmm 90mtr Ind Copper Wire Black", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "1.5sqmm 300mtr Ind Copper Wire Blue", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "1.5sqmm 300mtr Ind Copper Wire Green", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "1.5sqmm 300mtr Ind Copper Wire Frls", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "1.5sqmm 90mtr Ind Copper Wire Grey", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "1.5sqmm 90mtr Ind Copper Wire Red", Category: "Wires & Cables", Unit: "COILS" },
      { Item: "1.5sqmm 90mtr Ind Copper Wire Yellow", Category: "Wires & Cables", Unit: "COILS" }
    ];

    const searchInput = document.getElementById("search");
    const selectedDiv = document.getElementById("selected");
    let selectedItems = [];

    searchInput.addEventListener("keyup", function(e) {
      if (e.key === "Enter") {
        const query = searchInput.value.trim().toLowerCase();
        const found = inventory.find(item => item.Item.toLowerCase().includes(query));
        if (found) {
          selectedItems.push(found);
          renderSelected();
          searchInput.value = "";
        } else {
          alert("‚ùå Item not found in inventory!");
        }
      }
    });

    function renderSelected() {
      selectedDiv.innerHTML = "<b>Selected Items</b>";
      selectedItems.forEach((item, index) => {
        const div = document.createElement("div");
        div.className = "selected-item";
        div.innerHTML = `${item.Item} ‚Äî ${item.Unit}
          <button class="remove-btn" onclick="removeItem(${index})">Remove</button>`;
        selectedDiv.appendChild(div);
      });
    }

    function removeItem(index) {
      selectedItems.splice(index, 1);
      renderSelected();
    }

    // ‚úÖ Send via WhatsApp
    function sendWhatsApp() {
      let msg = "Enquiry:%0A";
      selectedItems.forEach(it => { msg += `${it.Item} ‚Äî ${it.Unit}%0A`; });
      window.open(`https://wa.me/918885750657?text=${msg}`, "_blank");
    }

    // ‚úÖ Email Formspree submission
    document.getElementById("enquiryForm").addEventListener("submit", function(e) {
      e.preventDefault();
      const formData = new FormData(this);
      formData.append("items", JSON.stringify(selectedItems));

      fetch("https://formspree.io/f/xnnzygoz", {
        method: "POST",
        body: formData,
        headers: { "Accept": "application/json" }
      }).then(response => {
        if (response.ok) {
          document.getElementById("successMessage").style.display = "block";
          selectedItems = [];
          renderSelected();
          this.reset();
        } else {
          alert("‚ùå Submission failed!");
        }
      });
    });
  </script>
</body>
</html> 
